---
title: 'STA 141A Spring 2020: Homework 3'
author: 'Instructor: Vaidotas Characiejus'
date: "5/1/2020"
output:
  html_document:
    number_sections: no
---


The assignment has to be done in an [R Markdown](https://rmarkdown.rstudio.com) document and submitted electronically on Canvas until the deadline of May 13, 2020 at 6:00 PM by uploading two files:

1. an HTML or PDF file;
2. the Rmd source file.

It is possible to upload two files on Canvas. Late submissions will not be accepted.

Each answer has to be based on `R` code that shows how the result was obtained. `R` code has to answer the question or solve the task. No points will be given for the answers that are not based on `R` code. 

The total number of points of this assignment is 30.

Good luck!


# Multiple linear regression


1. Run the following code to create the vectors `x1`, `x2`, and `y`.
```{r eval = FALSE}
set.seed(1)
n <- 100
x1 <- runif(n)
x2 <- runif(n,10,20)
y <- 2+2*x1+0.3*x2+rnorm(n)
```
a. (2 pts) The last line of the code above corresponds to creating a linear model in which `y` is a function of `x1` and `x2`. Write out the form of the linear model. What are the values of the regression coefficients $\beta_0$, $\beta_1$ and $\beta_2$? What is the value of $\sigma^2$?

b. (2 pts) What is the correlation coefficient between `x1` and `x2`? Create a scatter plot using `ggplot2` displaying the relationship between the variables `x1` and `x2`.

c. (4 pts) Fit a least squares regression to predict `y` using `x1` and `x2`. Describe the obtained results. What are the values of $\hat\beta_0$, $\hat\beta_1$ and $\hat\beta_2$? How do these relate to the true values of $\beta_0$, $\beta_1$ and $\beta_2$? What is the value of $s$ and how does it relate to the true value of $\sigma^2$? Can you reject the null hypothesis $H_0:\beta_1=0$? How about the null hypothesis $H_0:\beta_2=0$?

d. (3 pts) Now fit a least squares regression to predict `y` using only `x1`. Comment on your results. What are the values of $\hat\beta_0$ and $\hat\beta_1$? How do these relate to the true values of $\beta_0$ and $\beta_1$? What is the value of $s$ and how does it relate to the true value of $\sigma^2$? Can you reject the null hypothesis $H_0:\beta_1=0$?

e. (3 pts) Now fit a least squares regression to predict `y` using only `x2`. Comment on your results. What are the values of $\hat\beta_0$ and $\hat\beta_2$? How do these relate to the true values of $\beta_0$ and $\beta_2$? What is the value of $s$ and does it relate to the true value of $\sigma^2$? Can you reject the null hypothesis $H_0:\beta_2=0$?


2. Run the following code to create the vectors `x1`, `x2`, and `y`.
```{r eval = FALSE}
set.seed(1)
n <- 100
x1 <- runif(n)
x2 <- 0.5*x1+rnorm(n,0,.01)
y <- 2+2*x1+0.3*x2+rnorm(n)
```

a) (8 pts) Repeat parts b, c, d, and e of Exercise 1 using the new vectors `x1`, `x2` and `y`. What differences do you see between Exercise 1 and Exercise 2? Explain why these differences occur.


3. Use `x1`, `x2` and `y` from Exercise 2 and suppose that we obtain one additional observation, which was unfortunately mismeasured.
```{r eval = FALSE}
x1 <- c(x1, 0.1)
x2 <- c(x2, 0.8)
y <- c(y, 6)
```
a) (8 pts) Re-fit the linear models from parts c, d and e of Exercise 1 using this new data. What effect does this new observation have on the each of the models? In each model, is this observation an outlier? A high-leverage point? Both? Explain your answers.